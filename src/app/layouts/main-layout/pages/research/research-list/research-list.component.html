<div class="research d-flex flex-column gap-3 z-0">
  <div class="single-box d-flex flex-column p-5 mb-3">
    <form [formGroup]="researchForm" *ngIf="researchForm" (submit)="createResearch()" autocomplete="off" role="form" class="form-dark d-flex flex-column row">
      <div class="col form-group">
        <label for="groupId" class="form-label">Select Group <span class="text-danger">*</span></label>
        <input type="text" class="input-area" id="groupId" formControlName="groupId" [ngClass]="{ 'isInvalid': isFormSubmittedAndError('groupId') }" placeholder="Select select group" trim="blur">

        <div *ngIf="isFormSubmittedAndError('groupId')" class="invalid-feedback">
          <div *ngIf="isFormSubmittedAndError('groupId', 'required')">This field is required.</div>
        </div>
      </div>

      <div class="col form-group">
        <label for="postTitle" class="form-label">Paste article or video link <span class="text-danger">*</span></label>
        <input type="text" class="input-area" id="postTitle" formControlName="postTitle" [ngClass]="{ 'isInvalid': isFormSubmittedAndError('postTitle') }" placeholder="Paste article or video link" trim="blur">

        <div *ngIf="isFormSubmittedAndError('postTitle')" class="invalid-feedback">
          <div *ngIf="isFormSubmittedAndError('postTitle', 'required')">This field is required.</div>
        </div>
      </div>

      <div class="col-12 d-flex justify-content-end">
        <button type="submit" class="btn btn-sm btn-primary px-3 py-1 d-flex justify-content-center align-items-center gap-2">
          Post <i class="material-symbols-outlined font-20-px"> near_me </i>
        </button>
      </div>
    </form>
  </div>

  <div class="single-box d-flex flex-column p-5 mb-3">
    <h6 class="text-start mb-5">Freedom Messaging</h6>

    <div class="d-flex flex-column border-top pt-5 gap-3">
      <span class="font-12-px text-start"
        >RESEARCH OF TRUTH IS HOW WE UNITE</span
      >
      <span class="font-12-px text-start"
        >UNINFORMED PROGRAMMED FOLKS MUST BE BROUGHT UP TO SPEED</span
      >
      <span class="font-12-px text-start"
        >PLEASE SHARE INFO IN FACEBOOK AND TWITTER, ETC</span
      >
    </div>
  </div>

  <div class="single-box d-flex flex-column p-5 mb-3">
    <h6 class="text-start mb-5">Customize Your Feed</h6>

    <div
      class="btn-group"
      role="group"
      aria-label="Basic radio toggle button group"
    >
      <input
        type="radio"
        class="btn-check"
        name="btnGroupFeedType"
        [formControl]="btnGroupFeedTypeCtrl"
        value="All"
        id="btnRadioAll"
        autocomplete="off"
      />
      <label
        class="btn btn-outline-primary border-0 rounded"
        for="btnRadioAll"
        >All</label
      >

      <input
        type="radio"
        class="btn-check"
        name="btnGroupFeedType"
        [formControl]="btnGroupFeedTypeCtrl"
        value="Articles"
        id="btnRadioArticles"
        autocomplete="off"
      />
      <label
        class="btn btn-outline-primary border-0 rounded"
        for="btnRadioArticles"
        >Articles</label
      >

      <input
        type="radio"
        class="btn-check"
        name="btnGroupFeedType"
        [formControl]="btnGroupFeedTypeCtrl"
        value="Videos"
        id="btnRadioVideos"
        autocomplete="off"
      />
      <label
        class="btn btn-outline-primary border-0 rounded"
        for="btnRadioVideos"
        >Videos</label
      >

      <input
        type="radio"
        class="btn-check"
        name="btnGroupFeedType"
        [formControl]="btnGroupFeedTypeCtrl"
        value="Groups"
        id="btnRadioGroups"
        autocomplete="off"
      />
      <label
        class="btn btn-outline-primary border-0 rounded"
        for="btnRadioGroups"
        >Groups</label
      >
    </div>

    <ng-container *ngIf="btnGroupFeedTypeCtrl?.value === 'Groups'">
      <select name="research" class="input-area mt-5">
        <option
          *ngFor="let research of researches"
          [value]="research?.FirstName"
        >
          {{ research?.FirstName }}
        </option>
      </select>
    </ng-container>

    <div class="d-flex gap-5 pt-5 mt-5 border-top">
      <div class="form-check form-check-inline">
        <input
          class="form-check-input p-2"
          name="btnGroupViewType"
          type="radio"
          [formControl]="btnGroupViewTypeCtrl"
          id="btnRadioTopStories"
          value="TopStories"
        />
        <label class="form-check-label" for="btnRadioTopStories"
          >Top Stories View</label
        >
      </div>

      <div class="form-check form-check-inline">
        <input
          class="form-check-input p-2"
          name="btnGroupViewType"
          type="radio"
          [formControl]="btnGroupViewTypeCtrl"
          id="btnRadioMostRecent"
          value="MostRecent"
        />
        <label class="form-check-label" for="btnRadioMostRecent"
          >Most Recent View</label
        >
      </div>
    </div>
  </div>

  <ng-container *ngIf="groupPosts?.length > 0">
    <ng-container *ngFor="let group of groupPosts">
      <ng-container *ngIf="group?.name && group?.posts?.length > 0">
        <div class="single-box d-flex flex-column p-5 mb-3">
          <div class="d-flex justify-content-between align-items-center mb-5">
            <h6 class="text-start mb-0">{{ group?.name }}</h6>

            <a
              href="/research/detail/grpm/{{ group?.groupUniqueLink }}"
              target="_blank"
              class="material-symbols-outlined c-pointer"
              >chevron_right</a
            >
          </div>

          <ngb-carousel
            [showNavigationIndicators]="false"
            [interval]="0"
            (slide)="getNextPageGroupPostsById($event, group)"
          >
            <ng-container *ngFor="let post of group?.posts; let i = index">
              <ng-container *ngIf="i !== 0 && (i + 1) % pagination.limit === 0">
                <ng-template ngbSlide>
                  <div class="row px-2">
                    <ng-container *ngFor="let revIndex of pagination.limitArray">
                      <div class="px-2" [ngClass]="{'col-4': pagination.limit === 3, 'col-6': pagination.limit === 2, 'col-12': pagination.limit === 1}" >
                        <app-research-card [post]="group?.posts[i - revIndex]"/>
                      </div>
                    </ng-container>
                  </div>
                </ng-template>
              </ng-container>
            </ng-container>
          </ngb-carousel>
        </div>
      </ng-container>
    </ng-container>
  </ng-container>
</div>
